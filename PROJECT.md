# Stir-Fry POS ç³»çµ± - å°ˆæ¡ˆæ–‡ä»¶

# è¼¸å‡ºè¦æ ¼
> **èªè¨€è¦æ±‚**ï¼šæ‰€æœ‰å›è¦†ã€æ€è€ƒéç¨‹åŠä»»å‹™æ¸…å–®å¿…é ˆä½¿ç”¨**ç¹é«”ä¸­æ–‡**(zh-TW)ã€‚
> **å›ºå®šæŒ‡ä»¤**ï¼š`Implementation Plan, Task List and Thought in **Traditional Chinese**`
## å°ˆæ¡ˆæ¦‚è¿°

æ–°æ˜“ç¾ç‚’åº—é»é¤ç³»çµ± (Stir-Fry POS) æ˜¯ä¸€å€‹åŸºæ–¼ Next.js é–‹ç™¼çš„é¤å»³é»é¤ç®¡ç†ç³»çµ±ï¼Œæ•´åˆ Firebase ä½œç‚ºå¾Œç«¯è³‡æ–™åº«å’Œ LINE LIFF ä½œç‚ºå‰ç«¯ä½¿ç”¨è€…ä»‹é¢ã€‚

## æŠ€è¡“æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Vercel (ç”Ÿç”¢ç’°å¢ƒ)                      â”‚
â”‚              https://xin-yi-pos.vercel.app              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Next.js 14 (App Router)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å‰å° (å®¢æˆ¶)  â”‚  â”‚  å¾Œå° (ç®¡ç†)  â”‚  â”‚  QR Code     â”‚  â”‚
â”‚  â”‚  /menu       â”‚  â”‚  /admin      â”‚  â”‚  /admin/qr   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Firebase (xiyi-c4266)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Firestore  â”‚  â”‚  Storage   â”‚  â”‚    Auth    â”‚        â”‚
â”‚  â”‚  (è³‡æ–™åº«)  â”‚  â”‚  (åœ–ç‰‡)    â”‚  â”‚  (å¾…æ•´åˆ)  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å‰ç«¯æŠ€è¡“æ£§
- **æ¡†æ¶**: Next.js 14 (App Router)
- **èªè¨€**: TypeScript
- **æ¨£å¼**: CSS Modules
- **åœ–æ¨™**: lucide-react
- **ç‹€æ…‹ç®¡ç†**: React Context + useState

### å¾Œç«¯æœå‹™
- **è³‡æ–™åº«**: Firebase Firestore
- **æª”æ¡ˆå„²å­˜**: Firebase Storage
- **èº«ä»½é©—è­‰**: LINE LIFF (è¦åŠƒä¸­)

## å°ˆæ¡ˆçµæ§‹

```
stir-fry-pos/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router é é¢
â”‚   â”‚   â”œâ”€â”€ page.tsx           # é¦–é  (é‡å°å‘è‡³ /menu)
â”‚   â”‚   â”œâ”€â”€ menu/              # å‰å°é»é¤é é¢
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ menu.module.css
â”‚   â”‚   â”œâ”€â”€ admin/             # å¾Œå°ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx       # è¨‚å–®/èœå–®ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ login/         # ç®¡ç†å“¡ç™»å…¥
â”‚   â”‚   â”‚   â”œâ”€â”€ qr/            # QR Code ç”¢ç”Ÿå™¨
â”‚   â”‚   â”‚   â””â”€â”€ admin.module.css
â”‚   â”‚   â””â”€â”€ context/           # React Context
â”‚   â”‚       â””â”€â”€ AuthContext.tsx
â”‚   â”œâ”€â”€ lib/                   # æ ¸å¿ƒå‡½å¼åº«
â”‚   â”‚   â”œâ”€â”€ firebase.ts        # Firebase åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ firebaseConfig.ts  # Firebase é…ç½®
â”‚   â”‚   â”œâ”€â”€ storage.ts         # Firestore è³‡æ–™æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ imageUpload.ts     # åœ–ç‰‡ä¸Šå‚³/åˆªé™¤
â”‚   â”‚   â”œâ”€â”€ adminAuth.ts       # ç®¡ç†å“¡é©—è­‰
â”‚   â”‚   â”œâ”€â”€ menuData.ts        # é è¨­èœå–®è³‡æ–™
â”‚   â”‚   â””â”€â”€ mockData.ts        # Mock è³‡æ–™
â”‚   â””â”€â”€ types/                 # TypeScript å‹åˆ¥å®šç¾©
â”‚       â””â”€â”€ index.ts
â”œâ”€â”€ public/                    # éœæ…‹è³‡æº
â”‚   â”œâ”€â”€ alert.mp3             # è¨‚å–®é€šçŸ¥éŸ³æ•ˆ
â”‚   â””â”€â”€ placeholder.jpg       # åœ–ç‰‡ä½”ä½ç¬¦
â”œâ”€â”€ .env.local                # ç’°å¢ƒè®Šæ•¸ (æœ¬åœ°)
â”œâ”€â”€ firebase.json             # Firebase é…ç½®
â”œâ”€â”€ storage.rules             # Firebase Storage è¦å‰‡
â”œâ”€â”€ cors.json                 # CORS è¨­å®š
â””â”€â”€ package.json

```

## æ ¸å¿ƒåŠŸèƒ½

### å‰å° (å®¢æˆ¶ç«¯) - `/menu`
- âœ… æƒæ QR Code é€²å…¥é»é¤é é¢
- âœ… ç€è¦½èœå–®ï¼ˆä¾é¡åˆ¥ç¯©é¸ï¼Œå‹•æ…‹åˆ†é¡ï¼‰
- âœ… åŠ å…¥è³¼ç‰©è»Šï¼ˆæ”¯æ´å®¢è£½åŒ–é¸é …ï¼‰
- âœ… **å“é …æ•¸é‡èª¿æ•´**ï¼šç›´æ¥åœ¨èœå–®å¡ç‰‡ä¸Š +/- èª¿æ•´æ•¸é‡
- âœ… **è³¼ç‰©è»Šæ•¸é‡é¡¯ç¤º**ï¼šæŒ‰éˆ•é¡¯ç¤ºã€Œå·²åŠ å…¥ Xã€ç‹€æ…‹
- âœ… é€å‡ºè¨‚å–®è‡³ Firestore
- âœ… LINE é€šçŸ¥æ•´åˆï¼ˆå¾…å®Œå–„ï¼‰
- âœ… å¥½å‹é‚€è«‹æç¤ºï¼ˆé€²å…¥æ™‚è‡ªå‹•é¡¯ç¤ºï¼‰

### å¾Œå° (ç®¡ç†ç«¯) - `/admin`
- âœ… è¨‚å–®ç®¡ç†ï¼ˆç­‰å¾…ä¸­ã€è£½ä½œä¸­ã€å·²å®Œæˆï¼‰
- âœ… å»šæˆ¿çœ‹æ¿ï¼ˆå³æ™‚é¡¯ç¤ºè£½ä½œä¸­è¨‚å–®ï¼‰
- âœ… èœå–®ç®¡ç†ï¼ˆæ–°å¢ã€ç·¨è¼¯ã€åˆªé™¤ã€åœ–ç‰‡ä¸Šå‚³/åˆªé™¤ï¼‰
- âœ… **åˆ†é¡ç®¡ç†**ï¼šå‹•æ…‹æ–°å¢/åˆªé™¤åˆ†é¡ï¼ˆæª¢æŸ¥ä½¿ç”¨æƒ…æ³ï¼‰
- âœ… æ­·å²å¸³å‹™ï¼ˆç‡Ÿæ¥­é¡çµ±è¨ˆï¼‰
- âœ… QR Code ç”¢ç”Ÿå™¨
- âœ… å³æ™‚è¨‚å–®é€šçŸ¥éŸ³æ•ˆ

## ç’°å¢ƒè®Šæ•¸è¨­å®š

### `.env.local` å¿…è¦è®Šæ•¸

```bash
# Firebase Configuration
NEXT_PUBLIC_FIREBASE_API_KEY=AIzaSyBlJ8kU8aZyReaH6NP40G-uHeOTFXxwtfE
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=xiyi-c4266.firebaseapp.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=xiyi-c4266
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=xiyi-c4266.firebasestorage.app
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=355458948400
NEXT_PUBLIC_FIREBASE_APP_ID=1:355458948400:web:87a5968f18525ff10bbcf5
NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID=G-B7QK18HY6N

# LINE Configuration
CHANNEL_ACCESS_TOKEN=z9rZzIn7yNRAjpTKEaOr97LdWatv01cuh0zddsKQFjf4crO3HTiLAfa574xRNRP10xRvWFEXdmLq+K/ZEIcehNEVU1SSekZCfwJE+BHlGb7ncDE+OJxKuRqdJ2tVEimV+UmrYJu6h9D5RFcLy1MZygdB04t89/1O/w1cDnyilFU=
CHANNEL_SECRET=06c9612939f7987d1c9e9c42f285a5ab
NEXT_PUBLIC_LINE_LIFF_ID=2007818450-kYXd68rR
```

### Vercel ç’°å¢ƒè®Šæ•¸
éœ€è¦åœ¨ Vercel Dashboard â†’ Settings â†’ Environment Variables è¨­å®šä¸Šè¿°æ‰€æœ‰è®Šæ•¸ã€‚

## éƒ¨ç½²æµç¨‹

### 1. æœ¬åœ°é–‹ç™¼

```bash
# å®‰è£ä¾è³´
npm install

# å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨
npm run dev

# åœ¨ç€è¦½å™¨é–‹å•Ÿ http://localhost:3000
```

### 2. Firebase è¨­å®š

```bash
# éƒ¨ç½² Storage è¦å‰‡
firebase deploy --only storage

# è¨­å®š CORSï¼ˆè‹¥éœ€è¦ï¼‰
gsutil cors set cors.json gs://xiyi-c4266.firebasestorage.app
```

### 3. éƒ¨ç½²è‡³ Vercel

```bash
# æ–¹æ³•ä¸€ï¼šé€é Vercel CLI
npm install -g vercel
vercel login
vercel --prod

# æ–¹æ³•äºŒï¼šé€é GitHub è‡ªå‹•éƒ¨ç½²
# 1. æ¨é€è‡³ GitHub main åˆ†æ”¯
git push origin main

# 2. Vercel è‡ªå‹•åµæ¸¬ä¸¦éƒ¨ç½²
```

### 4. è¨­å®šåˆ¥åï¼ˆè‹¥éœ€è¦ï¼‰

```bash
vercel alias set <deployment-url> xin-yi-pos.vercel.app
```

## ç®¡ç†å“¡å¸³è™Ÿ

é è¨­ç®¡ç†å“¡å¸³è™Ÿå¯†ç¢¼ï¼ˆå¯«æ­»åœ¨ç¨‹å¼ç¢¼ä¸­ï¼‰ï¼š
- **å¸³è™Ÿ**: `admin`  
- **å¯†ç¢¼**: `admin`

> âš ï¸ **å®‰å…¨å»ºè­°**: æ­£å¼ç’°å¢ƒæ‡‰æ”¹ç”¨ Firebase Authentication

## é‡è¦ä¿®æ­£è¨˜éŒ„

### åœ–ç‰‡ä¸Šå‚³ CORS éŒ¯èª¤
- **å•é¡Œ**: URL ä¸­å‡ºç¾ `%0A`ï¼ˆæ›è¡Œç¬¦ï¼‰
- **è§£æ±º**: åœ¨ `firebaseConfig.ts` ä¸­ç¡¬ç·¨ç¢¼ `storageBucket` åç¨±

### ç·¨è¼¯é¤é»å„²å­˜å¾Œ Modal ä¸é—œé–‰
- **å•é¡Œ**: ç•°æ­¥å„²å­˜é˜»å¡ UI æ›´æ–°
- **è§£æ±º**: ä½¿ç”¨ `setTimeout` å»¶é²ç‹€æ…‹æ›´æ–°è‡³ä¸‹ä¸€å€‹äº‹ä»¶å¾ªç’°

### QR Code æƒæå•é¡Œ
- **å•é¡Œ**: LIFF URL å°å‘å•é¡Œ
- **è§£æ±º**: æ”¹ç”¨æ‡‰ç”¨ç¨‹å¼ç›´æ¥ URL (`/menu?table={tableId}`)

### å‹•æ…‹åˆ†é¡ç®¡ç†ç³»çµ± (2025-11-25)
- **æ–°å¢**: å®Œæ•´çš„åˆ†é¡ç®¡ç†åŠŸèƒ½
- **å¯¦ä½œ**: 
  - å°‡åˆ†é¡å¾ç¡¬ç·¨ç¢¼æ”¹ç‚º Firestore å„²å­˜
  - å¾Œå°æ–°å¢ã€Œåˆ†é¡ç®¡ç†ã€æ¨™ç±¤é 
  - æ”¯æ´æ–°å¢/åˆªé™¤åˆ†é¡ï¼ˆåˆªé™¤å‰æª¢æŸ¥èœå–®ä½¿ç”¨æƒ…æ³ï¼‰
  - å‰å¾Œå°å³æ™‚åŒæ­¥åˆ†é¡æ›´æ–°
- **æŠ€è¡“**: `CategoryItem` å‹åˆ¥ã€StorageService æ“´å±•

### å‰å°è³¼ç‰©è»Šæ•¸é‡é¡¯ç¤º (2025-11-25)
- **æ–°å¢**: èœå–®å¡ç‰‡é¡¯ç¤ºå·²åŠ å…¥æ•¸é‡
- **å¯¦ä½œ**:
  - æŒ‰éˆ•é¡¯ç¤ºã€Œå·²åŠ å…¥ Xã€ä¸¦è®Šæ›´é¡è‰²
  - ä½¿ç”¨ `getItemQuantityInCart()` è¨ˆç®—æ•¸é‡
  - ç¶ è‰²è¦–è¦ºæ¨™ç¤ºå·²åŠ å…¥ç‹€æ…‹

### å‰å°å“é …æ•¸é‡èª¿æ•´ (2025-11-25)
- **æ–°å¢**: ç›´æ¥åœ¨èœå–®å¡ç‰‡ä¸Šèª¿æ•´æ•¸é‡
- **å¯¦ä½œ**:
  - æ•¸é‡ = 0ï¼šé¡¯ç¤ºã€ŒåŠ å…¥ã€æŒ‰éˆ•
  - æ•¸é‡ > 0ï¼šé¡¯ç¤º +/- æŒ‰éˆ•å’Œæ•¸é‡
  - ç„¡éœ€æ‰“é–‹è³¼ç‰©è»Šå³å¯å¢æ¸›
- **æ”¹é€²**: ç§»é™¤æœƒå“¡å„ªæƒ æ©«å¹…ï¼ˆå·²åœ¨é€²å…¥æ™‚è¦æ±‚åŠ å…¥å¥½å‹ï¼‰

### åœ–ç‰‡ä¸Šå‚³æŒä¹…åŒ–ä¿®å¾© (2025-11-25)
- **å•é¡Œ**: åœ–ç‰‡ä¸Šå‚³å¾Œé‡æ–°æ•´ç†æ¶ˆå¤±
- **è¨ºæ–·**: å¢åŠ è©³ç´°çš„ Console é™¤éŒ¯æ—¥èªŒ
- **ä¿®å¾©**: ç¢ºä¿ `editingItem` çš„æœ€æ–°å€¼ï¼ˆå« imageUrlï¼‰è¢«æ­£ç¢ºå„²å­˜
- **æé†’**: ä¸Šå‚³åœ–ç‰‡å¾Œéœ€é»æ“Šã€Œå„²å­˜ã€æŒ‰éˆ•

## è³‡æ–™æ¨¡å‹

### MenuItem (èœå–®é …ç›®)
```typescript
{
  id: string;           // å”¯ä¸€è­˜åˆ¥ç¢¼
  name: string;         // é¤é»åç¨±
  price: number;        // åƒ¹æ ¼
  category: Category;   // é¡åˆ¥
  imageUrl: string;     // åœ–ç‰‡ URL
  description?: string; // æè¿°
  available: boolean;   // æ˜¯å¦ä¾›æ‡‰
  options?: MenuOption[]; // å®¢è£½åŒ–é¸é …
}
```

### Order (è¨‚å–®)
```typescript
{
  id: string;           // è¨‚å–®ID
  tableId: string;      // æ¡Œè™Ÿ
  items: CartItem[];    // å“é …æ¸…å–®
  totalAmount: number;  // ç¸½é‡‘é¡
  status: 'pending' | 'cooking' | 'served'; // ç‹€æ…‹
  createdAt: string;    // å»ºç«‹æ™‚é–“
  lineUserId?: string;  // LINE ç”¨æˆ¶ID
}
```

### CategoryItem (åˆ†é¡é …ç›®) - **æ–°å¢**
```typescript
{
  id: string;           // åˆ†é¡å”¯ä¸€è­˜åˆ¥ç¢¼
  name: string;         // åˆ†é¡åç¨±ï¼ˆå¦‚ï¼šéµæ¿é¡ï¼‰
  displayOrder: number; // é¡¯ç¤ºé †åº
  createdAt: Date;      // å»ºç«‹æ™‚é–“
}
```

## æœ€è¿‘æ›´æ–° (2025-11-25)

### âœ… å·²å®Œæˆ
- âœ… å‹•æ…‹åˆ†é¡ç®¡ç†ç³»çµ±ï¼ˆFirestore å„²å­˜ï¼‰
- âœ… å‰å°è³¼ç‰©è»Šæ•¸é‡é¡¯ç¤º
- âœ… å‰å°å“é …æ•¸é‡èª¿æ•´ï¼ˆ+/- æŒ‰éˆ•ï¼‰
- âœ… åœ–ç‰‡ä¸Šå‚³æŒä¹…åŒ–ä¿®å¾©
- âœ… ç§»é™¤æœƒå“¡å„ªæƒ æ©«å¹…
- âœ… å¢åŠ é™¤éŒ¯æ—¥èªŒè¿½è¹¤

### ğŸ”„ é€²è¡Œä¸­
- [ ] æ•´åˆ LINE LIFF çœŸå¯¦ç™»å…¥
- [ ] å¯¦ä½œ LINE è¨‚å–®é€šçŸ¥
- [ ] åŠ å¼·ç®¡ç†å“¡èº«ä»½é©—è­‰ï¼ˆFirebase Authï¼‰

### ğŸ“‹ å¾…è¾¦äº‹é …

- [ ] æ•´åˆ LINE LIFF çœŸå¯¦ç™»å…¥
- [ ] å¯¦ä½œ LINE è¨‚å–®é€šçŸ¥
- [ ] åŠ å¼·ç®¡ç†å“¡èº«ä»½é©—è­‰ï¼ˆFirebase Authï¼‰
- [ ] æ–°å¢è¨‚å–®ä¿®æ”¹åŠŸèƒ½
- [ ] å ±è¡¨èˆ‡æ•¸æ“šåˆ†æ
- [ ] å¤šèªç³»æ”¯æ´

## è¯çµ¡è³‡è¨Š

- **GitHub**: [chengyou0503/XIN-YI](https://github.com/chengyou0503/XIN-YI)
- **Vercel**: `https://xin-yi-pos.vercel.app`
- **Firebase Project**: `xiyi-c4266`
